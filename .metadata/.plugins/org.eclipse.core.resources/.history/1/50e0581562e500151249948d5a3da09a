var read = function() {
	var db = Ti.Database.open("redditDB");
	db.execute("CREATE TABLE IF NOT EXISTS redditTBL (id INTEGER PRIMARY KEY, title TEXT, author TEXT, image TEXT)");
	var dbRows = db.execute("SELECT title, author, image FROM redditTBL");
	if (dbRows) {
		var lsArray = [];
		while (dbRows.isValidRow()){
			lsArray.push({
				title: dbRows.fieldByName("title"),
				author: dbRows.fieldByName("author"),
				img: dbRows.fieldByName("image")
			});
			dbRows.next();
			
		}
		console.log("lsArray:", lsArray);
		uiModule.buildUI(lsArray);
		
	} else {
		alert("No network, no local storage.");
	}
	
};

var save = function(apiInfo) {
	//console.log("apiInfo: ", apiInfo);
	//console.log("apiInfo: " + JSON.stringify(apiInfo));

	var db = Ti.Database.open("redditDB");
	db.execute("CREATE TABLE IF NOT EXISTS redditTBL (id INTEGER PRIMARY KEY, title TEXT, author TEXT, image TEXT)");
	for ( i = 0, j = apiInfo.length; i < j; i++) {

		db.execute("INSERT INTO redditTBL (title, author, image) VALUES (?, ?, ?)", apiInfo[i].title, apiInfo[i].author, apiInfo[i].thumb);
	}
	db.close();
	
	read();
	
};
exports.save = save;
exports.read = read; 